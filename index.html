<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>SmartXO - لعبة XO احترافية</title>
  <style>
    :root{
      --bg:#0f1724; --card:#0b1220; --accent:#06b6d4; --muted:#94a3b8; --glass: rgba(255,255,255,0.04);
    }
    *{box-sizing:border-box;font-family:"Segoe UI", Tahoma, Arial, sans-serif}
    body{margin:0;background:linear-gradient(180deg,#071029 0%, #071022 100%);color:#e6eef6;min-height:100vh;display:flex;align-items:center;justify-content:center;padding:24px}
    .container{width:100%;max-width:960px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border-radius:14px;padding:20px;box-shadow:0 10px 30px rgba(2,6,23,0.7)}
    header{display:flex;gap:12px;align-items:center;justify-content:space-between;margin-bottom:14px}
    h1{font-size:20px;margin:0}
    .controls{display:flex;gap:10px;align-items:center}
    select,button{background:var(--glass);border:1px solid rgba(255,255,255,0.04);color:inherit;padding:8px 12px;border-radius:8px}
    .board-wrap{display:flex;gap:20px;flex-wrap:wrap}
    .board{width:360px;max-width:100%;aspect-ratio:1;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border-radius:12px;padding:18px;display:grid;grid-template-columns:repeat(3,1fr);grid-template-rows:repeat(3,1fr);gap:10px}
    .cell{background:rgba(255,255,255,0.02);display:flex;align-items:center;justify-content:center;font-size:46px;border-radius:8px;cursor:pointer;user-select:none;transition:transform .08s ease, background .12s}
    .cell:hover{transform:scale(1.02);background:rgba(255,255,255,0.03)}
    .cell.disabled{cursor:not-allowed;opacity:.7}
    .side{flex:1;min-width:240px;display:flex;flex-direction:column;gap:12px}
    .card{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));padding:14px;border-radius:12px;border:1px solid rgba(255,255,255,0.03)}
    .score{display:flex;gap:12px;align-items:center;justify-content:space-around;font-size:14px}
    .turn{font-weight:600;color:var(--accent)}
    footer{margin-top:12px;font-size:12px;color:var(--muted);display:flex;justify-content:space-between}
    .highlight{color:var(--accent);font-weight:700}
    .winner{padding:8px;border-radius:8px;text-align:center}
    @media(max-width:700px){.board-wrap{flex-direction:column}.side{order:2}}
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>SmartXO — لعبة XO احترافية</h1>
      <div class="controls">
        <label for="mode">الوضع:</label>
        <select id="mode">
          <option value="pvp">شخص ضد شخص</option>
          <option value="pvc">شخص ضد الكمبيوتر</option>
        </select>
        <label for="difficulty">الصعوبة:</label>
        <select id="difficulty">
          <option value="easy">سهل</option>
          <option value="hard">صعب</option>
        </select>
        <button id="resetBtn">بدء جديد</button>
      </div>
    </header>
    <main class="board-wrap">
      <div class="board card" id="board"></div>
      <aside class="side">
        <div class="card">
          <div>حالة اللعبة: <span id="status" class="turn">X يبدأ</span></div>
          <div style="margin-top:10px" id="winnerArea"></div>
        </div>
        <div class="card score">
          <div>X: <span id="scoreX">0</span></div>
          <div>O: <span id="scoreO">0</span></div>
          <div>تعادلات: <span id="scoreD">0</span></div>
        </div>
      </aside>
    </main>
  </div>
<script>
const boardEl=document.getElementById('board');const statusEl=document.getElementById('status');const winnerArea=document.getElementById('winnerArea');const modeSelect=document.getElementById('mode');const difficultySelect=document.getElementById('difficulty');const resetBtn=document.getElementById('resetBtn');const scoreX=document.getElementById('scoreX');const scoreO=document.getElementById('scoreO');const scoreD=document.getElementById('scoreD');let board=Array(9).fill(null);let currentPlayer='X';let gameOver=false;let scores={X:0,O:0,D:0};const wins=[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];function createBoard(){boardEl.innerHTML='';for(let i=0;i<9;i++){const div=document.createElement('div');div.className='cell';div.dataset.index=i;div.addEventListener('click',onCellClick);boardEl.appendChild(div);}}function onCellClick(e){const idx=Number(e.currentTarget.dataset.index);if(gameOver||board[idx])return;if(modeSelect.value==='pvc'&&currentPlayer==='O')return;makeMove(idx,currentPlayer);if(!gameOver){if(modeSelect.value==='pvc'){if(currentPlayer==='X'){currentPlayer='O';updateStatus();setTimeout(()=>computerPlay(),400);}else{}}else{currentPlayer=currentPlayer==='X'?'O':'X';updateStatus();}}}function makeMove(idx,player){if(board[idx]||gameOver)return;board[idx]=player;const cell=boardEl.querySelector(`[data-index='${idx}']`);cell.textContent=player;cell.classList.add('disabled');const winner=checkWinner(board);if(winner){endGame(winner);return;}if(board.every(Boolean)){endGame('draw');return;}}function checkWinner(b){for(const line of wins){const[a,b1,c]=line;if(b[a]&&b[a]===b[b1]&&b[a]===b[c])return b[a];}return null;}function endGame(result){gameOver=true;if(result==='draw'){winnerArea.innerHTML='<div class="winner">تعادل!</div>';scores.D++;scoreD.textContent=scores.D;statusEl.textContent='انتهت اللعبة — تعادل';}else{winnerArea.innerHTML=`<div class="winner">الفائز: <span style=\"color:#06b6d4\">${result}</span></div>`;scores[result]++;if(result==='X')scoreX.textContent=scores.X;else scoreO.textContent=scores.O;statusEl.textContent=`انتصار ${result}`;highlightWinningLine(result);}}function highlightWinningLine(winner){for(const line of wins){const[a,b1,c]=line;if(board[a]===winner&&board[b1]===winner&&board[c]===winner){[a,b1,c].forEach(i=>boardEl.querySelector(`[data-index='${i}']`).style.boxShadow='inset 0 0 40px rgba(6,182,212,0.12)');}}}function updateStatus(){statusEl.textContent=gameOver?statusEl.textContent:`${currentPlayer} دور اللاعب`;}
function resetBoard(clearScores=false){board=Array(9).fill(null);currentPlayer='X';gameOver=false;winnerArea.innerHTML='';createBoard();updateStatus();if(clearScores){scores={X:0,O:0,D:0};scoreX.textContent=0;scoreO.textContent=0;scoreD.textContent=0;}}
function computerPlay(){if(gameOver)return;let idx;if(difficultySelect.value==='easy'){const empties=board.map((v,i)=>v?null:i).filter(v=>v!==null);idx=empties[Math.floor(Math.random()*empties.length)];}else{idx=bestMove(board,'O');}makeMove(idx,'O');if(!gameOver){currentPlayer='X';updateStatus();}}
function bestMove(bd,player){if(bd.every(v=>v===null)&&bd[4]===null)return 4;const result=minimax(bd.slice(),player,player);return result.index;}
function minimax(bd,player,maximizingPlayer){const avail=bd.map((v,i)=>v?null:i).filter(v=>v!==null);const winner=checkWinner(bd);if(winner==='X')return{score:-10};if(winner==='O')return{score:10};if(avail.length===0)return{score:0};const moves=[];for(const i of avail){const move={};move.index=i;bd[i]=player;const res=minimax(bd,player==='O'?'X':'O',maximizingPlayer);move.score=res.score;bd[i]=null;moves.push(move);}let bestMove;if(player===maximizingPlayer){let bestScore=-Infinity;for(const m of moves){if(m.score>bestScore){bestScore=m.score;bestMove=m;}}}else{let bestScore=Infinity;for(const m of moves){if(m.score<bestScore){bestScore=m.score;bestMove=m;}}}return bestMove;}
createBoard();updateStatus();resetBtn.addEventListener('click',()=>resetBoard());modeSelect.addEventListener('change',()=>{resetBoard();difficultySelect.disabled=(modeSelect.value==='pvp');});resetBtn.addEventListener('dblclick',()=>resetBoard(true));window.addEventListener('keydown',e=>{if(e.key==='r')resetBoard();if(e.key==='R')resetBoard(true);});
</script>
</body>
</html>